<html>
<head>
    <meta charset="UTF-8">
    <script src="jquery-1.11.3.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="placeholder.js"></script>
    <link rel="stylesheet" href="jquery-ui.min.css">
    
    
    
</head>
<body>

    <style>
        .ui-widget-content { width: 100px; height: 40px; padding: 0.5em; }
        #feedback { font-size: 1.4em; }
	    .selectable .ui-selecting { background: #FECA40; }
	    .selectable .ui-selected { background: #F39814; color: white; }
	    .selectable { list-style-type: none; margin: 0; padding: 0; width: 10%; }
	    .selectable li { margin: 3px; padding: 0.4em; font-size: 1.4em; height: 18px; }
    </style>

<select name="gene" id="gene">
    <option value="" disabled selected>--selecione--</option>
</select>

    <div id="heredograma" class="heredograma"> 
        <div class="geracao" id="0">
            <button onclick="addPessoa(0)">+ Pessoa</button>
            <ol class="selectable" id="pessoas0"></ol>
        </div> 
        <hr>
        <div class="geracao" id="1">
            <button onclick="addPessoa(1)">+ Pessoa</button>
            <ol class="selectable" id="pessoas1"></ol>
        </div> 
        <hr>
        <div class="geracao" id="2">
            <button onclick="addPessoa(2)">+ Pessoa</button>
            <ol class="selectable" id="pessoas2"></ol>
        </div> 
        <hr>
        <div class="geracao" id="3">
            <button onclick="addPessoa(3)" title="testan">+ Pessoa</button>
            <button onclick="addGeracao()" id="add-geracao">+ Geração</button>
            <ol class="selectable" id="pessoas3"></ol>
        </div> 
    </div> 

    <div id="menuPessoa">

    </div>
<script type="text/javascript">

$(function() {
    $( document ).tooltip();
	$( ".selectable" ).selectable({
      stop: function() {
        var result = "";
        $( ".ui-selected", this ).each(function() {
          closeMenu();
        });
      },
      selected: function() {
        $( ".ui-selected", this ).each(function() {
            //console.log(this.id)
            pessoaId = this.id.substring(6)
            pessoa = pessoas[pessoaId]
            console.log(pessoas)
            menuPessoa(pessoa)
        });
      }

    });
	
});

var root = document.getElementById("heredograma")

function addGeracao(){
    botao = document.getElementById("add-geracao")
    newgen = document.createElement("div")
    newgen.setAttribute("class", "geracao")

    id = parseInt(botao.parentElement.id)
    newgen.setAttribute("id", id + 1)


    botaoPessoa = document.createElement("button")
    botaoPessoa.setAttribute("onclick", "addPessoa("+(id + 1)+")")
    botaoPessoa.textContent = "+ Pessoa"

    pessoas = document.createElement("ol")
    pessoas.setAttribute("class", "selectable")
    pessoas.setAttribute("id", "pessoas"+(id + 1))

    newgen.appendChild(botaoPessoa)
    newgen.appendChild(botao)
    newgen.appendChild(pessoas)

    hr = document.createElement("hr")
    root.appendChild(hr)
    root.appendChild(newgen)
}




function getXml(xml){
    if (window.XMLHttpRequest){
        xmlhttp=new XMLHttpRequest()
    }
    else{
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")
    }
    xmlhttp.open("GET", xml, false)
    xmlhttp.send()
    xmlDocument=xmlhttp.responseXML
    return xmlDocument
}

function setupGenes(){
    xmlDocument = getXml("genes.xml")
    selectGenes = document.getElementById("gene")

    genes = xmlDocument.getElementsByTagName("gene")
    for (i = 0; i < genes.length; i++){
        g = genes[i]
        element = document.createElement("option")
        element.setAttribute("value", g.getAttribute("id"))
        element.textContent = g.getAttribute("name")
        selectGenes.appendChild(element)
    }
}
setupGenes()
</script>
</body>
</html>

